#FastD-php-simple-framework for PHP5.4+ 

#version: 1.0.x

**ç®€å•**ã€**é«˜æ•ˆ**ã€**æ•æ·**ã€**çµæ´»**ã€**ç»„ä»¶å¼æ›´æ–°**

#å‘èµ·äºº 
* JanHuang / bboyjanhuang@gmail.com

#ç»´æŠ¤è€…
* JanHuang / bboyjanhuang@gmail.com

###ç®€ä»‹
æ»¡æ»¡éƒ½æ˜¯FastDï¼ŒFastDæ˜¯ä½ ï¼Œä½ æ˜¯FastDï¼ŒFastDï¼Œè®©å¼€å‘å……æ»¡ä¹è¶£ã€‚

###ç‰¹è‰²

	1) ç®€å• 
	2) çµæ´» 
	3) RESTfulè·¯ç”± 
	4) composerå®‰è£…/ç®¡ç† 
	5) çµæ´»é…ç½® 
	6) éµå¾ªPSRå‘½åè§„èŒƒ 
	7) é¢å‘å¯¹è±¡ 
	8) å‘½ä»¤è¡Œ
	9) ç›´è§‚çš„æ–‡ä»¶å¸ƒå±€

###å‚è€ƒ

PSR-*: [http://www.php-fig.org/](http://www.php-fig.org/)

Composer: [http://getcomposer.org/](http://getcomposer.org/)

Git: [http://git-scm.com/book/zh/v1](http://git-scm.com/book/zh/v1)

=========

#ï¼ƒç¯å¢ƒé…ç½®

###ç¯å¢ƒè¦æ±‚

* PHP >= 5.4.*


##å¦‚æœä½ è§‰å¾—å®‰è£…è¿‡äºå¤æ‚ï¼Œæ²¡å…³ç³»ï¼Œæˆ‘å·²ç»æ‰“åŒ…å¥½äº†ã€‚ç›´æ¥å»ä¸‹è½½å§ã€‚

åœ°å€ï¼š[https://coding.net/u/janhuang/p/FastD-framework-stable-src/git](https://coding.net/u/janhuang/p/FastD-framework-stable-src/git)

*å¯»æ‰¾æ ‡ç­¾ï¼Œæœ€æ–°çš„ç‰ˆæœ¬å³å¯ã€‚*

=====

&nbsp;

##ï¼ƒå¦‚æœä¸€ä¸‹ç¯å¢ƒé…ç½®è¿‡çš„ï¼Œè¯·å¿½ç•¥ã€‚

*ç¯å¢ƒé…ç½®å»ºè®®ä½¿ç”¨ vagrant è¿›è¡Œé…ç½®ï¼Œ ä¹Ÿæ˜¯å»ºè®®PHPå¼€å‘äººå‘˜é…å¤‡çš„ã€‚*

###å®‰è£…Composer

`composer` ä¸‹è½½åœ°å€: [composer](https://getcomposer.org)

###å®‰è£…FastD

åœ¨å®‰è£…æœ¬æ¡†æ¶å‰éœ€è¦ç¡®ä¿æ­£ç¡®å®‰è£… `composer` ä¾èµ–ç®¡ç†ã€‚

`composer create-project janhuang/FastD-php-simple-framework path v1.1.1`

**æ³¨æ„ï¼šå› ä¸ºå›½å†…è®¿é—®composerè¶…çº§ç¼“æ…¢çš„é—®é¢˜ï¼Œå»ºè®®ä½¿ç”¨ä»£ç†æˆ–è€…å›½å†…é•œåƒè¿›è¡Œå®‰è£…**

===

&nbsp;

###éšè—æ–‡ä»¶ `(dev|local|prod).php`ï¼ˆä¼˜é›…é“¾æ¥ï¼‰

####è¯´æ˜ï¼šä¸ºç¥é©¬æœ‰ä¸‰ä¸ªå…¥å£æ–‡ä»¶

ä¸‰ä¸ªæ–‡ä»¶åˆ†åˆ«å¯¹åº”ï¼š

`dev.php` --->  å¼€å‘ç¯å¢ƒï¼Œä¹Ÿå°±æ˜¯æµ‹è¯•ç¯å¢ƒ åŠ è½½`config_dev.php`é…ç½®æ–‡ä»¶

`local.php` ->  é’ˆå¯¹æœ¬åœ°ç¯å¢ƒï¼Œå¼€å‘æœº åŠ è½½`config_local.php`é…ç½®æ–‡ä»¶

`prod.php` ->  é’ˆå¯¹ç”Ÿäº§ç¯å¢ƒï¼Œ åŠ è½½`config_prod.php`é…ç½®æ–‡ä»¶

é€šè¿‡gitè¿›è¡Œä»£ç ç®¡ç†ï¼Œå¯ä»¥å¿«é€Ÿéƒ¨ç½²åº”ç”¨ï¼Œå°†ä¾èµ–é™åˆ°æœ€ä½ã€‚ä¸ä¿¡ï¼Ÿä½ è¯•è¯•çœ‹

###Apache

æ¡†æ¶é€šè¿‡ `public/.htaccess`æ–‡ä»¶æ¥å®ç°ä¼˜é›…é“¾æ¥ï¼Œéšè— `(dev|local|prod).php`ã€‚åœ¨è®¿é—®ä¸­ä¸éœ€è¦å¸¦ `(dev|local|prod).php`ï¼Œä½†æ˜¯è¦ç¡®å®šçš„æ˜¯ï¼Œéœ€è¦å¼€å¯ `mod_rewrite` æ¨¡å—

###Nginx

```
server {
	#setting......
    location / {
            try_files $uri @rewriteapp;
    }
    location @rewriteapp {
            rewrite ^(.*)$ /prod.php$1 last;
    }
    location ~ ^/(dev|local|prod)\.php(/|$) {
    	#setting......
        fastcgi_split_path_info ^(.+.php)(/.*)$; #è§£æPHP pathinfo
        fastcgi_param PATH_INFO $fastcgi_path_info; #æ–°å¢PHP pathinfo
    }
}
```

ä»¥ä¸Šæ˜¯éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒï¼Œæµ‹è¯•ç¯å¢ƒéœ€è¦è°ƒæ•´ `prod.php` æ–‡ä»¶å³å¯

=====

&nbsp;


#åºŸè¯ä¸å¤šè¯´ï¼Œèµ¶ç´§æ’¸

====

#ï¼ƒåŸºæœ¬åŠŸèƒ½

	1 è·¯ç”±
	2 äº‹ä»¶
	3 Makeå·¥å…·
	

##ï¼ƒ1. è·¯ç”±

è·¯ç”±è¶³å¤Ÿå‚è€ƒ`Laravel`æ¡†æ¶ï¼Œä½†æ˜¯ä¸åŒçš„ï¼Œå¯ä»¥é…ç½®å¤šä¸ªä¸åŒé¡¹ç›®çš„è·¯ç”±ç»„ï¼Œç”¨ä»¥åŒºåˆ†é¡¹ç›®ï¼Œå…·ä½“å¦‚ä½•åšåˆ°æ›´å¥½ç†è§£å’Œç›´è§‚ï¼Œéœ€è¦ä½ è‡ªå·±æ‰‹åŠ¨å»æ˜æ˜ã€‚è·¯ç”±é…ç½®æ–‡ä»¶è¯¦è§: `app/routes.php` å’Œé¡¹ç›®è·¯å¾„ä¸‹ `Resources/config/routes.php`

åˆ›å»ºè·¯ç”±æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œè€Œä¸”åˆ†åˆ«æ”¯æŒ `GET, POST, PUT, DELETE, HEAD, OPTIONS, ANY`ã€‚

åˆ›å»ºè·¯ç”±é€šè¿‡ `Routes` ç±»åˆ›å»ºã€‚

###ï¼ƒRoutes API

#####@Route::

###ï¼ƒè·¯ç”±

####GET

#####`@Routes::get(string|array, callback);`

####@examples:

æ™®é€šè·¯ç”±ï¼š

```
Routes::get('/', function () {
	return 'hello get';
});
```

å¸¦æœ‰è·¯ç”±åå­—çš„è·¯ç”±ï¼š

```
Routes::get(['/', 'name' => 'welcome'], function () {
	return 'hello name';
});
```

##å¦‚ä½•è®¿é—®ï¼Ÿä½ ä»–ä¹ˆåœ¨é€—æˆ‘ã€‚

è¾“å…¥: `http://localhost/path/to/project/public/`

å³å¯è¾“å‡ºä»¥ä¸Šçš„: `hello name`

ä¸ºä½•èƒ½å¤Ÿè¾“å‡º `hello name`

è¿™é‡Œçš„è¯ï¼Œå› ä¸ºè·¯ç”±ç»‘å®šçš„æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ä¼šè§¦å‘åŒ¿åå‡½æ•°ã€‚è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œå‡½æ•°ä½“å†…å¿…éœ€ `return` ç›¸å…³ä¿¡æ¯ã€‚å¦‚æœè¿”å›çš„æ•°ç»„ï¼Œä¼šé»˜è®¤ç»™ä½ è¿”å› `\FastD\Http\JsonResponse` å¯¹è±¡ï¼Œ å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ä¼šè¿”å› `\FastD\Http\Response`

è·¯ç”±èµ„æºåˆ›å»ºå®Œæˆåå›è¿”å› `\FastD\Routing\RouteInterface` å¯¹è±¡ï¼Œå¯ä»¥åŠ¨æ€é…ç½®è·¯ç”±ä¿¡æ¯

ä¾‹å¦‚ï¼š

```
Routes::get('/', function () {})->setName('welcome');
```

&nbsp;

å…¶ä»–è·¯ç”±å®šä¹‰å¦‚æ­¤ç±»æ¨ã€‚è¯·ç®€å•çœ‹çœ‹ä»¥ä¸‹ä¾‹å­ï¼š

====

###@Routes::post

#####`@Routes::post(string|array, callback);`

å¸¦æœ‰è®¿é—®é™åˆ¶çš„è·¯ç”±, åªå…è®¸ `post` è®¿é—®

```
Routes::post(['/post', 'name' => 'post'], function () {
	return 'hello post';
});
```


====

###@Routes::put

#####`@Routes::put(string|array, callback);`

å¸¦æœ‰è®¿é—®é™åˆ¶çš„è·¯ç”±, åªå…è®¸ `put` è®¿é—®

```
Routes::put(['/put', 'name' => 'put'], function () {
	return 'hello put';
});
```


====

###@Routes::delete

#####`@Routes::delete(string|array, callback);`

å¸¦æœ‰è®¿é—®é™åˆ¶çš„è·¯ç”±, åªå…è®¸ `delete` è®¿é—®

```
Routes::delete(['/delete', 'name' => 'delete'], function () {
	return 'hello delete';
});
```


====

###@Routes::head

#####`@Routes::head(string|array, callback);`

å¸¦æœ‰è®¿é—®é™åˆ¶çš„è·¯ç”±, åªå…è®¸ `head` è®¿é—®

```
Routes::post(['/head', 'name' => 'head'], function () {
	return 'hello head';
});
```


====

###@Routes::options

#####`@Routes::options(string|array, callback);`

å¸¦æœ‰è®¿é—®é™åˆ¶çš„è·¯ç”±, åªå…è®¸ `options` è®¿é—®

```
Routes::post(['/options', 'name' => 'options'], function () {
	return 'hello options';
});
```


====

###@Routes::any

#####`@Routes::any(string|array, callback);`

å…è®¸æ‰€æœ‰è®¿é—®

```
Routes::post(['/any', 'name' => 'any'], function () {
	return 'hello any';
});
```

====

&nbsp;

##ï¼ƒ2. äº‹ä»¶

        äº‹ä»¶ã€‚ä¸€ä¸ªä¸é™Œç”Ÿçš„åè¯ï¼Œå´ä¹Ÿæ˜¯ä¸€ä¸ªä¸æ˜“ç†è§£çš„åè¯ã€‚åœ¨ `javascript` ä¸­äº‹ä»¶ç›¸ä¿¡éƒ½ä¸é™Œç”Ÿï¼Œä½†æ˜¯åœ¨ "ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€" `php` ä¸­åˆæ˜¯æ€ä¹ˆä¸€ä¸ªæ¦‚å¿µå‘¢ï¼Ÿé¦–å…ˆè¦ç†è§£ä¸€ç‚¹å¾ˆå®¹æ˜“çš„å°±æ˜¯ï¼Œç”¨æˆ·çš„æ¯ä¸€ä¸ªè¯·æ±‚ï¼Œå…¶å®å°±æ˜¯æ¯ä¸€ä¸ªç›¸åŒçš„äº‹ä»¶: *è¯·æ±‚äº‹ä»¶*ã€‚ å½“ç„¶å¯ä»¥åœ¨è¿™ä¸ªè¯·æ±‚äº‹ä»¶ä¸­ç»‘å®šä¸åŒçš„è§¦å‘å™¨ã€‚ä¾‹å¦‚æœ€ç®€å•çš„å°±æ˜¯ä¸€ä¸ªç®€å•çš„MVCæ¡†æ¶ï¼Œå¯ä»¥åœ¨æ¯æ¬¡è®¿é—®éƒ½è°ƒç”¨åˆ¶å®šçš„æ§åˆ¶å™¨ä¸€æ ·ï¼Œå…¶æ§åˆ¶å™¨å°±æ˜¯ç»‘å®šäº†æŒ‡å®šçš„è·¯ç”±åœ°å€ï¼Œå› ä¸ºç”¨æˆ·åœ¨è®¿é—®çš„æ—¶å€™å°±å‡ºå‘äº†é‚£ä¸ªäº‹ä»¶ã€‚

åœ¨ `FastD php simple framework` ä¸­ï¼Œå·²ç»åˆ é™¤äº†æ§åˆ¶å™¨çš„æ¦‚å¿µäº†ï¼Œåªæœ‰äº‹ä»¶ç»‘å®šï¼Œå½“ç„¶äº‹ä»¶æœºåˆ¶ç›®å‰è¿˜ä¸æ˜¯å¾ˆå®Œå–„ï¼Œå¯ä»¥è¯´ç”šè‡³è¿˜æ²¡æˆå‹ï¼Œä½†æ˜¯è¿™ä¸ªæ˜¯æœªæ¥æ–¹å‘ã€‚æ¡†æ¶ä¸­çº¦å®šæ¯ä¸ªè·¯ç”±ç»‘å®šä¸€ä¸ªæˆ–è€…å¤šä¸ªäº‹ä»¶ï¼Œåœ¨è§¦å‘äº‹ä»¶ä¸­å¯ä»¥åœ¨ç»‘å®šæŒ‡å®šäº‹ä»¶ã€‚ä¸‹åˆ—æŒ‡å®šä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š


====


è·¯ç”±åœ°å€ï¼š

```
Routes::get('/', function () {
	return 'hello world';
});
```

ä»¥ä¸Šè·¯ç”± `/` ç»‘å®šäº†ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œåœ¨ç”¨æˆ·è¯·æ±‚ `/` è·¯ç”±åœ°å€çš„æ—¶å€™ï¼ŒåŒ¿åå‡½æ•°å°±ä¼šè§¦å‘ï¼Œæ‰§è¡Œç›¸åº”çš„é€»è¾‘ã€‚

é™¤äº†ç»‘å®šåŒ¿åè¿˜ä¹¦ï¼Œè¿˜å¯ä»¥ç»‘å®šæŒ‡å®šçš„ç±»ï¼Œæ‰§è¡Œæ–¹æ³•æœ‰ä¸¤ç§ï¼Œä¸€ä¸ªæ˜¯æ‰‹åŠ¨å®ä¾‹åŒ–ï¼Œå¦å¤–ä¸€ç§æ˜¯å­—ç¬¦ä¸²æ˜ å°„ã€‚

æ‰‹åŠ¨å®ä¾‹åŒ–ï¼š

```
Routes::get('/', array(new event, handle));
```

æ‰‹åŠ¨å®ä¾‹åŒ–ä¸èƒ½å®ç°ä¾èµ–æ³¨å…¥ï¼Œéœ€è¦æ‰‹åŠ¨æ³¨å…¥ã€‚

å­—ç¬¦ä¸²æ˜ å°„ï¼š

```
Routes::get('/', 'Demo\Event@handle');
```

å­—ç¬¦ä¸²æ˜ å°„ï¼Œåˆ™å¯ä»¥è‡ªåŠ¨æ³¨å…¥æ‰€éœ€å¯¹è±¡ã€‚ä½†æ‰§è¡Œæ•ˆç‡ä¼šç•¥æ…¢æ‰‹åŠ¨ã€‚

è¶Šç‰¹ä¹ˆæ™ºèƒ½çš„ä¸œè¥¿è¶Šæ…¢ï¼Œè¶Šçƒ¦ççš„ä¸œè¥¿è¶Šå¿«ã€‚ è¿™å¥è¯çœŸå¯¹ç¼–ç 


====

##ï¼ƒ3. Makeå·¥å…·

Makeå·¥å…·ï¼Œç”¨äºå…¨å±€å¿«é€Ÿï¼Œçµæ´»åˆ›å»ºå’Œä½¿ç”¨å¯¹è±¡ã€‚æ²¡æœ‰å¤æ‚çš„å·¥åºï¼Œç®€å•è‡ªç”±çš„æ•´åˆç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œå¹¶ä¸”è‡ªç”±é…ç½®ã€‚

å…¶å®Makeæ²¡æœ‰é‚£ä¹ˆç¥ã€‚åªæ˜¯åœ¨åº”ç”¨åˆå§‹åŒ–çš„æ—¶å€™åŠ åœ¨è¿›å»äº†å†…å­˜ï¼Œæ‰€ä»¥å¯ä»¥å…¨å±€ä½¿ç”¨ã€‚è€Œä¸”Makeå·¥å…·æ–¹æ³•å‡ä¸ºé™æ€(static)ï¼Œæ‰€ä»¥çµæ´»ï¼›å› ä¸ºMakeå·¥å…·åªè´Ÿè´£ä¸­é—´è°ƒåº¦ï¼Œæ‰€ä»¥ç®€å•ã€‚ä½ ä¹Ÿå¯ä»¥éšå¿ƒæ‰€æ¬²çš„æ•´åˆç¬¬ä¸‰æ–¹å·¥å…·åŒ…ï¼Œåˆ©ç”¨Makeä½œä¸ºä¸­é—´è°ƒåº¦å±‚ï¼Œå‰ææ˜¯ä½ åšçš„å·¥å…·è¶³å¤Ÿçµæ´»é…ç½®ã€‚ã€‚ã€‚

Makeå·¥å…·æ‰€å«APIï¼š

&nbsp;

æˆ‘ç‰¹ä¹ˆè¿™é‡Œå°±ä¸å†™äº†ã€‚è‡ªå·±çœ‹ä»£ç å»ã€‚è·¯å¾„ `app/kernel/Make.php`ã€‚ é‡Œé¢çš„æ–¹æ³•éƒ½å¾ˆç®€å•ï¼Œä¸€ç›®äº†ç„¶ï¼Œçœ‹ä¸æ‡‚çš„è‡ªå·±é¢å£å»ã€‚

====

#ï¼ƒæ•°æ®åº“

æ•°æ®åº“ï¼Œè¿™ä¸œè¥¿ä¼šç”¨çš„äººå¤šï¼Œæ‡‚çš„äººå°‘ï¼Œç²¾çš„äººæ›´å°¼ç›å°‘ã€‚è¯´å¤šéƒ½æ˜¯æ³ªã€‚

ç”¨å’±ä»¬ `FastD` å»åˆ›å»ºæ•°æ®åº“è¿æ¥ä¹Ÿå¾ˆç®€å•ï¼Œè€Œä¸”æ”¯æŒå¤šåº“æŸ¥è¯¢å“¦ï¼Œä¹ˆä¹ˆå“’ã€‚

===

###1. ä½¿ç”¨Makeå·¥å…·åˆ›å»ºæ•°æ®åº“è¿æ¥

`Make:db($connection);`

`$connection` å‚æ•°éœ€è¦å‚è€ƒç¯å¢ƒé…ç½®æ–‡ä»¶ `config_(dev|local|prod).php` é‡Œé¢çš„ `database` é…ç½®é¡¹ï¼Œåˆ†åˆ«å¯¹åº”é“¾æ¥ç±»å‹ã€‚ä¸¾ä¸ªğŸŒ°ï¼š

é…ç½®æ–‡ä»¶ä¿¡æ¯ï¼š

```
    // setting
'database' => [
        'write' => [
            'database_type'     => 'mysql',
            'database_host'     => 'localhost',
            'database_port'     => 3306,
            'database_user'     => 'root',
            'database_pwd'      => '123456',
            'database_charset'  => 'utf8',
            'database_name'     => 'test',
            'database_prefix'   => ''
        ],
        'read' => [
            'database_type'     => 'mysql',
            'database_host'     => 'localhost',
            'database_port'     => 3306,
            'database_user'     => 'root',
            'database_pwd'      => '123456',
            'database_charset'  => 'utf8',
            'database_name'     => 'test',
            'database_prefix'   => ''
        ],
    ],
    // setting
```

å‚è€ƒä¸Šè¿°é…ç½®ï¼Œå¦‚æœè¦è·å–"å†™"åº“é“¾æ¥ï¼Œé€šè¿‡Makeå·¥å…·åˆ›å»ºï¼Œåˆ™éœ€è¦ `Make::db('write')`ï¼Œbingoï¼Œå°±è¿™ä¹ˆç®€å•ï¼Œæƒ³é“¾æ¥å“ªä¸ªå°±é“¾æ¥å“ªä¸ªï¼Œå“ªé‡Œä¸ä¼šç‚¹å“ªé‡Œäº†ã€‚

====

##2. æŸ¥è¯¢ã€‚

å…¶å®è¿™äº›æˆ‘éƒ½ä¸æƒ³è¯´äº†ã€‚å¤ªç®€å•çš„äº†ï¼Œéƒ½æ˜¯åŸºæœ¬æ“ä½œï¼Œä¸è¿‡è¿˜æ˜¯ç®€å•è¯´ä¸€ä¸‹ã€‚

####æ‰§è¡ŒæŸ¥æ‰¾

#####åŸºç¡€æŸ¥æ‰¾

æŸ¥æ‰¾ä¸€æ¡æ•°æ®

`find($where = array(), [$fields = '*'])`

æŸ¥æ‰¾æ‰€æœ‰æ•°æ®

`findAll($where = array(), [$fields = '*'])`

æ ¹æ®æ¡ä»¶æŸ¥æ‰¾ä¸€æ¡æ•°æ®

`findBy($where = array(), [$fields = '*'])`

æ ¹æ®æ¡ä»¶æŸ¥æ‰¾æ‰€æœ‰æ•°æ®

`findAllBy($where = array(), [$fields = '*'])`

çµæ´»æ ¹æ®æ¡ä»¶æŸ¥æ‰¾ä¸€æ¡æ•°æ®

`findByå­—æ®µå($where = array(), [$fields = '*'])` å¦‚ï¼š`findById(1) => findBy(array('id' => 1))`

çµæ´»æ ¹æ®æ¡ä»¶æŸ¥æ‰¾æ‰€æœ‰æ•°æ®

`findByå­—æ®µå($where = array(), [$fields = '*'])`

å¦‚ï¼š 

`findAllByTitle('hello') => findAllBy(array('title' => 'hello'));`
`findAllByCatId(1) => findAllBy(array('cat_id' => 1));`

#####åŸºç¡€ä¸šåŠ¡æ“ä½œ

æ’å…¥

`insert($datas = array());`

æ›´æ–°

`update($where = array(), $datas = array())`

åˆ é™¤,è¿™é‡Œåˆ é™¤æ•°æ®ä¸å…è®¸åˆ é™¤æ•´ä¸ªè¡¨æ•°æ®ï¼Œåªå…è®¸åˆ é™¤ç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼Œè¿™é‡Œæ¡ä»¶å‚æ•°æ¯”ä¼ 

`delete($where = array());`

####å­—å®šä¹‰æ•°æ®æŸ¥è¯¢

è¿™é‡Œæ•°æ®æŸ¥è¯¢è¿”å›çš„æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„

`createQuery($dql);`

`getQuery()`

`getResult()`

å¦‚ï¼š

`$connection->createQuery('sql')->getQuery()->getResult()`

&nbsp;

ä»¥ä¸Šæ‰€æœ‰æŸ¥è¯¢ç»“æœè¿”å›çš„æ˜¯ `\FastD\Database\Result\ResultCollection` å¯¹è±¡ï¼Œå®ç° `AccessArray, Iterator` æ¥å£ï¼Œå¯æ ¼å¼åŒ–ï¼Œé€šè¿‡ `toArray, toJson, toObject...` ç­‰è¿›è¡Œæ ¼å¼åŒ–

##3. æ¨¡å‹åº“ Repository

åˆ›å»ºæ•°æ®åº“è¿æ¥åï¼Œå¯ä»¥é€šè¿‡ `getRepository` è¿›è¡Œè·å–æ¨¡å‹åº“ï¼Œæ¨¡å‹åº“é»˜è®¤æŒ‰ç…§ç±»åè¿›è¡Œæ•°æ®è¡¨æ˜ å°„ã€‚æ¯”å¦‚ `PostRepository` => prefix_postã€‚ æ•°æ®åº“åä¸€å¾‹å°å†™ã€‚

å…¶ä»–æ–¹æ³•è·Ÿä¸Šè¿°ä¸€æ ·ï¼Œè¯¦ç»†è¯·è‡ªè¡Œç ”ç©¶ï¼Œæ•´ä½“ä¸å¤æ‚ï¼ŒåŸºäº `medoo` è¿›è¡Œæ•´åˆã€‚

å†™æ–‡æ¡£çœŸå°¼ç›ç´¯ã€‚

====

#ï¼ƒkey/valueå­˜å‚¨

##1. åˆ›å»ºé“¾æ¥

æ ¹æ®é…ç½®æ–‡ä»¶é…ç½®

```
 // å­˜å‚¨é…ç½®
    'storage' => [
        'write' => [
            'type' => 'redis',
            'host' => '11.11.11.11',
            'port' => 6379
        ],
    ],
```

é€šè¿‡Makeå·¥å…·åˆ›å»ºã€‚ `Make::storage('write')` å³å¯è‡ªè¡Œé“¾æ¥

ç±»å‹æŒ‡å®šé€šè¿‡ `type` å­—æ®µæŒ‡å®šã€‚ ç›®å‰æ”¯æŒ `redis, memcache, memcached, ssdb`ã€‚ `disque` æš‚æ—¶ä¸æ”¯æŒ

===

#ï¼ƒTemplateæ¨¡æ¿å¼•æ“

æ¨¡æ¿å¼•æ“é»˜è®¤ä½¿ç”¨twigï¼Œç›®å‰ä¹Ÿåªæ•´åˆtwigæ¨¡æ¿å¼•æ“

é€šè¿‡ `Make::render($template, array $paramters = array())` æ¨¡æ¿è·¯å¾„åœ¨ `app/views` å’Œ `src`æ‰€æœ‰ç›®å½•ä¸‹ï¼Œæ¸²æŸ“æ¨¡æ¿éœ€è¦å®Œæ•´è·¯å¾„ã€‚å…·ä½“ä½¿ç”¨å¯ä»¥å‚è€ƒtwigæ¨¡æ¿å¼•æ“ã€‚

æ¨¡æ¿å¼•æ“é…ç½®é€šè¿‡ `config` ä¸‹é¢çš„templateè¿›è¡Œé…ç½®ã€‚é»˜è®¤é…ç½®é¡¹è¯·çœ‹é…ç½®æ–‡ä»¶

===

#ï¼ƒè¾…åŠ©ç±» helpers

é€šè¿‡ `Make::helpers()` åˆ›å»ºã€‚æ”¯æŒä¾èµ–æ³¨å…¥å“¦ï¼Œä¹ˆä¹ˆå“’ã€‚å…¶ä»–åŠ¨æ€å‚æ•°éœ€è¦åœ¨åˆ›å»ºçš„æ—¶å€™è¿›è¡Œæ‰‹åŠ¨æ³¨å…¥ã€‚

æ·»åŠ è¾…åŠ©ç±»ã€‚

é€šè¿‡ `Application::registerHelpers` æ–¹æ³•è¿›è¡Œæ³¨å†Œã€‚å¯ä»¥ä½¿ç”¨ç±»å®Œæ•´ç±»åè¿›è¡Œæ³¨å†Œï¼Œä¹Ÿå¯ä»¥ç›´æ¥å®ä¾‹åŒ–æ³¨å†Œï¼Œåæ­£å†™è¿›å»å°±è¡Œäº†ã€‚

*è®°å¾—å†™ä¸‹è¾…åŠ©ç±»çš„åå­—ï¼Œæ–¹ä¾¿è·å–*

#####@example

```
public function registerHelpers()
    {
        return array(
            'demo' => 'Helpers\\Demo\\Demo'
        );
    }
```

é”®åå°±æ˜¯è¾…åŠ©ç±»çš„åˆ«åäº†ã€‚ç›´æ¥é€šè¿‡ `Make::helpers('demo')` è·å–

## æ„Ÿå—

æ–‡æ¡£å†™çš„å¾ˆç´¯å•Šã€‚å°¼ç›ï¼ŒåŸºæœ¬åŠŸèƒ½ä»¥ä¸Šäº†ã€‚è¿˜æœ‰æ›´å¤šä¸°å¯Œçš„ã€‚å”‰ï¼Œå°¼ç›å¥½å¤šå•Šï¼Œè¦å†™åˆ°å•¥æ—¶å€™ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å…ˆä¸å†™äº†ï¼Œä½ ä»¬è¡¥å……ã€‚

====

#Author

*Name*:  **[JanHuang](http://segmentfault.com/blog/janhuang)**

*Blog*: **[http://segmentfault.com/blog/janhuang](http://segmentfault.com/blog/janhuang)**

*EMail*:  **bboyjanhuang@gmail.com**

====

#License MIT


